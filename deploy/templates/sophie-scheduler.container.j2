[Unit]
Description=Sophie Scheduler
Requires=mongo.service valkey.service

[Service]
ExecStartPre=/bin/sleep 5
Restart=always

[Container]
ContainerName=scheduler
Image={{ lookup('ansible.builtin.env','IMAGE_NAME', default='registry.gitlab.com/sophiebot/sophie') }}:{{ image_tag }}
PublishPort=8072:8072
PodmanArgs=--memory=1G
EnvironmentFile=/var/sophie/scheduler.env
Exec=scheduler

[Install]
WantedBy=multi-user.target default.target
